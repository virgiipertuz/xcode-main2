<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pinturas Helios S.A.S - Sistema de Gestión</title>
  <link rel="stylesheet" href="/src/css/estilo_dashboard.css"> <!-- Enlace al archivo CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

  <!-- Menú lateral -->
  <nav class="menu-lateral">
    <h2>Pinturas Helios S.A</h2>
    <a href="#" data-seccion="pedidos">Pedidos y Despachos</a>
    <a href="#" data-seccion="proveedores">Gestión de Proveedores</a>
    <a href="#" data-seccion="inventario">Gestión de Inventario</a>
    <a href="#" data-seccion="usuarios">Configuración y Gestión de Usuarios</a>
    <a href="#" data-seccion="soporte">Soporte Técnico y Mantenimiento</a>
  </nav>

  <!-- Contenido principal -->
  <main class="contenido">

    <!-- Sección: Soporte Técnico -->
    <section id="soporte" class="seccion activa">
      <div class="reporte-problema">
        <div class="section-content">
          <h2>Soporte Técnico y Mantenimiento</h2>
          <div class="grid-container">
            <!-- Formulario de Reporte -->
            <div class="card">
              <div class="card-header">
                <h3>Reporte de Problemas</h3>
              </div>
              <div class="card-body">
                <form id="reportForm" class="form">
                  <div class="form-group">
                    <label for="soporte_descripcion">Descripción del Problema</label>
                    <textarea id="soporte_descripcion" name="descripcion" class="form-control" rows="4" required></textarea>
                  </div>
                  <div class="form-group">
                    <label for="fecha">Fecha y Hora de Ocurrencia</label>
                    <input type="datetime-local" id="fecha" name="fecha" class="form-control" required>
                  </div>
                  <div class="form-group">
                    <label for="pantallazo">Adjuntar Pantallazo</label>
                    <input type="file" id="pantallazo" name="pantallazo" class="form-control" accept="image/*">
                  </div>
                  <button type="submit" class="btn btn-primary">Enviar Reporte</button>
                </form>
              </div>
            </div>

            <!-- Documentación -->
            <div class="card">
              <div class="card-header">
                <h3>Documentación</h3>
              </div>
              <div class="card-body">
                <div class="doc-section">
                  <h4>Manuales de Usuario</h4>
                  <ul class="doc-list">
                    <li><i class="material-icons">picture_as_pdf</i><a href="#">Manual de Usuario - Sistema X</a><span class="doc-meta">PDF - Última actualización: 2024</span></li>
                    <li><i class="material-icons">description</i><a href="#">Manual de Usuario - Sistema Y</a><span class="doc-meta">Word - Última actualización: 2024</span></li>
                  </ul>
                </div>
                <div class="doc-section">
                  <h4>Procedimientos Operativos</h4>
                  <ul class="doc-list">
                    <li><i class="material-icons">picture_as_pdf</i><a href="#">POE de Seguridad Industrial</a><span class="doc-meta">PDF - Última actualización: 2024</span></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>

        <script>
          document.getElementById('reportForm').addEventListener('submit', function (e) {
            e.preventDefault();

            const formData = new FormData(this);
            const report = {
              descripcion: formData.get('descripcion'),
              fecha: formData.get('fecha'),
              pantallazo: formData.get('pantallazo').name
            };

            console.log('Reporte:', report);
            // Simulación de envío exitoso
            alert('Reporte enviado con éxito');
            this.reset();
          });
        </script>
      </div>
    </section>

    <!-- Sección: Gestión de Proveedores -->
    <section id="proveedores" class="seccion">
      <div class="section-content">
        <h2>Gestión de Proveedores</h2>

        <div class="grid-container">
          <!-- Formulario de Registro/Edición de Proveedor -->
          <div class="card">
            <div class="card-header">
              <h3 id="proveedores_formTitle">Registro de Proveedor</h3>
            </div>
            <div class="card-body">
              <form id="providerForm" class="form">
                <input type="hidden" id="providerId" name="id">
                <div class="form-row">
                  <div class="form-group">
                    <label for="proveedores_nombre">Nombre/Razón Social</label>
                    <input type="text" id="proveedores_nombre" name="nombre" class="form-control" required>
                  </div>
                  <div class="form-group">
                    <label for="ruc">RUC</label>
                    <input type="text" id="ruc" name="ruc" class="form-control" required pattern="\d{11}" title="El RUC debe tener 11 dígitos">
                  </div>
                </div>
                <div class="form-group">
                  <label for="direccion">Dirección</label>
                  <input type="text" id="direccion" name="direccion" class="form-control" required>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="telefono">Teléfono</label>
                    <input type="tel" id="telefono" name="telefono" class="form-control" required>
                  </div>
                  <div class="form-group">
                    <label for="email">Correo Electrónico</label>
                    <input type="email" id="email" name="email" class="form-control" required>
                  </div>
                </div>
                <div class="form-group">
                  <label for="productos">Productos/Servicios</label>
                  <textarea id="productos" name="productos" class="form-control" rows="2"></textarea>
                </div>
                <div class="form-actions">
                  <button type="submit" class="btn btn-primary">Guardar Proveedor</button>
                  <button type="button" id="proveedores_cancelEdit" class="btn btn-text" style="display: none;">Cancelar Edición</button>
                </div>
              </form>
            </div>
          </div>

          <!-- Lista de Proveedores -->
          <div class="card">
            <div class="card-header">
              <h3>Proveedores Registrados</h3>
              <div class="search-box">
                <input type="text" id="searchProvider" class="form-control" placeholder="Buscar proveedor...">
              </div>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table">
                  <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>RUC</th>
                      <th>Teléfono</th>
                      <th>Email</th>
                      <th>Estado</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody id="providerList"></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <script src="../../js/utils/helpers.js"></script>
        <script src="../../js/modules/providers.js"></script>
        <script>
          window.initProveedores = function () {
            console.log('Inicializando módulo de proveedores...');
            loadProviders();
          };

          document.addEventListener('DOMContentLoaded', () => {
            const providerForm = document.getElementById('providerForm');
            const providerList = document.getElementById('providerList');
            const searchInput = document.getElementById('searchProvider');
            const formTitle = document.getElementById('proveedores_formTitle');
            const cancelEditBtn = document.getElementById('proveedores_cancelEdit');
            let editingId = null;

            function loadProviders() {
              const providers = Providers.getAllProviders();
              renderProviders(providers);
            }

            function renderProviders(providers) {
              providerList.innerHTML = providers.map(provider => `
                <tr class="${provider.estado === 'inactivo' ? 'inactive-row' : ''}">
                    <td>${Helpers.sanitizeInput(provider.nombre)}</td>
                    <td>${Helpers.sanitizeInput(provider.ruc)}</td>
                    <td>${Helpers.sanitizeInput(provider.telefono)}</td>
                    <td>${Helpers.sanitizeInput(provider.email)}</td>
                    <td><span class="status-badge ${provider.estado === 'activo' ? 'active' : 'inactive'}">${provider.estado}</span></td>
                    <td>
                        <button class="btn btn-sm btn-text" onclick="editProvider('${provider.id}')" ${provider.estado === 'inactivo' ? 'disabled' : ''}><i class="material-icons">edit</i></button>
                        <button class="btn btn-sm btn-text" onclick="toggleProviderStatus('${provider.id}')"><i class="material-icons">${provider.estado === 'activo' ? 'block' : 'restore'}</i></button>
                    </td>
                </tr>`).join('');
            }

            function resetForm() {
              providerForm.reset();
              editingId = null;
              formTitle.textContent = 'Registro de Proveedor';
              cancelEditBtn.style.display = 'none';
              document.getElementById('providerId').value = '';
              document.getElementById('ruc').removeAttribute('readonly');
            }

            providerForm.addEventListener('submit', (e) => {
              e.preventDefault();
              const formData = new FormData(providerForm);
              const provider = {
                nombre: formData.get('nombre'),
                ruc: formData.get('ruc'),
                direccion: formData.get('direccion'),
                telefono: formData.get('telefono'),
                email: formData.get('email'),
                productos: formData.get('productos')
              };
              try {
                if (editingId) {
                  Providers.updateProvider(editingId, provider);
                  Helpers.handleError({ message: 'Proveedor actualizado con éxito' });
                } else {
                  Providers.addProvider(provider);
                  Helpers.handleError({ message: 'Proveedor registrado con éxito' });
                }
                resetForm();
                loadProviders();
              } catch (error) {
                Helpers.handleError(error);
              }
            });

            searchInput.addEventListener('input', (e) => {
              const filteredProviders = Providers.searchProviders(e.target.value);
              renderProviders(filteredProviders);
            });

            cancelEditBtn.addEventListener('click', resetForm);
            loadProviders();
          });

          window.editProvider = function (id) {
            const provider = Providers.getProvider(id);
            if (provider) {
              editingId = id;
              document.getElementById('providerId').value = id;
              document.getElementById('proveedores_nombre').value = provider.nombre;
              document.getElementById('ruc').value = provider.ruc;
              document.getElementById('ruc').readOnly = true;
              document.getElementById('direccion').value = provider.direccion;
              document.getElementById('telefono').value = provider.telefono;
              document.getElementById('email').value = provider.email;
              document.getElementById('productos').value = provider.productos || '';
              document.getElementById('proveedores_formTitle').textContent = 'Editar Proveedor';
              document.getElementById('proveedores_cancelEdit').style.display = 'inline-block';
            }
          };

          window.toggleProviderStatus = function (id) {
            const provider = Providers.getProvider(id);
            if (provider && confirm(`¿Está seguro de ${provider.estado === 'activo' ? 'desactivar' : 'reactivar'} este proveedor?`)) {
              try {
                if (provider.estado === 'activo') {
                  Providers.deleteProvider(id);
                  Helpers.handleError({ message: 'Proveedor desactivado con éxito' });
                } else {
                  Providers.updateProvider(id, { estado: 'activo' });
                  Helpers.handleError({ message: 'Proveedor reactivado con éxito' });
                }
                loadProviders();
              } catch (error) {
                Helpers.handleError(error);
              }
            }
          };
        </script>
      </div>
    </section>

    <section id="inventario" class="seccion">
      <div class="section-content">
        <h2>Gestión de Inventario</h2>

        <div class="grid-container">
          <!-- Formulario de Registro/Edición de Producto -->
          <div class="card">
            <div class="card-header">
              <h3 id="inventario_formTitle">Registro de Producto</h3>
            </div>
            <div class="card-body">
              <form id="productForm" class="form">
                <input type="hidden" id="productId" name="id">
                <div class="form-row">
                  <div class="form-group">
                    <label for="codigo">Código</label>
                    <input type="text" id="codigo" name="codigo" class="form-control" required>
                  </div>
                  <div class="form-group">
                    <label for="inventario_nombre">Nombre del Producto</label>
                    <input type="text" id="inventario_nombre" name="nombre" class="form-control" required>
                  </div>
                </div>
                <div class="form-group">
                  <label for="inventario_descripcion">Descripción</label>
                  <textarea id="inventario_descripcion" name="descripcion" class="form-control" rows="2"></textarea>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="categoria">Categoría</label>
                    <select id="categoria" name="categoria" class="form-control" required>
                      <option value="">Seleccione una categoría</option>
                      <option value="Industrial">Industrial</option>
                      <option value="Arquitectónico">Arquitectónico</option>
                      <option value="Automotriz">Automotriz</option>
                      <option value="Marino">Marino</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="inventario_proveedor_select">Proveedor</label>
                    <select id="inventario_proveedor_select" name="proveedor" class="form-control" required></select>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="stock">Stock</label>
                    <input type="number" id="stock" name="stock" class="form-control" required min="0">
                  </div>
                  <div class="form-group">
                    <label for="unidad">Unidad</label>
                    <select id="unidad" name="unidad" class="form-control" required>
                      <option value="Galón">Galón</option>
                      <option value="Litro">Litro</option>
                      <option value="Balde">Balde</option>
                      <option value="Kit">Kit</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="precio">Precio</label>
                    <input type="number" id="precio" name="precio" class="form-control" required min="0" step="0.01">
                  </div>
                </div>
                <div class="form-actions">
                  <button type="submit" class="btn btn-primary">Guardar Producto</button>
                  <button type="button" id="inventario_cancelEdit" class="btn btn-text" style="display: none;">Cancelar Edición</button>
                </div>
              </form>
            </div>
          </div>

          <!-- Lista de Productos -->
          <div class="card">
            <div class="card-header">
              <h3>Productos en Inventario</h3>
              <div class="search-box">
                <input type="text" id="searchProduct" class="form-control" placeholder="Buscar producto...">
              </div>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table">
                  <thead>
                    <tr>
                      <th>Código</th>
                      <th>Nombre</th>
                      <th>Categoría</th>
                      <th>Stock</th>
                      <th>Precio</th>
                      <th>Estado</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody id="productList"></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <script src="../../js/utils/helpers.js"></script>
        <script src="../../js/modules/providers.js"></script>
        <script src="../../js/modules/inventory.js"></script>
        <script>
          window.initInventario = function () {
            console.log('Inicializando módulo de inventario...');
            loadProveedores();
            loadProducts();
          };

          document.addEventListener('DOMContentLoaded', () => {
            const productForm = document.getElementById('productForm');
            const productList = document.getElementById('productList');
            const searchInput = document.getElementById('searchProduct');
            const formTitle = document.getElementById('inventario_formTitle');
            const cancelEditBtn = document.getElementById('inventario_cancelEdit');
            const proveedorSelect = document.getElementById('inventario_proveedor_select');
            let editingId = null;

            function loadProveedores() {
              const proveedores = Providers.getActiveProviders();
              proveedorSelect.innerHTML = '<option value="">Seleccione un proveedor</option>' +
                proveedores.map(proveedor => `<option value="${proveedor.id}">${proveedor.nombre}</option>`).join('');
            }

            function loadProducts() {
              const products = Inventory.getAllProducts();
              renderProducts(products);
            }

            function renderProducts(products) {
              const proveedores = Providers.getAllProviders();
              productList.innerHTML = products.map(product => {
                const proveedor = proveedores.find(p => p.id === product.proveedor);
                return `
                  <tr class="${product.estado === 'inactivo' ? 'inactive-row' : ''}">
                    <td>${Helpers.sanitizeInput(product.codigo)}</td>
                    <td>${Helpers.sanitizeInput(product.nombre)}</td>
                    <td>${Helpers.sanitizeInput(product.categoria)}</td>
                    <td>${product.stock} ${product.unidad}</td>
                    <td>S/ ${product.precio.toFixed(2)}</td>
                    <td><span class="status-badge ${product.estado === 'activo' ? 'active' : 'inactive'}">${product.estado}</span></td>
                    <td>
                      <button class="btn btn-sm btn-text" onclick="editProduct('${product.id}')" ${product.estado === 'inactivo' ? 'disabled' : ''}><i class="material-icons">edit</i></button>
                      <button class="btn btn-sm btn-text" onclick="toggleProductStatus('${product.id}')"><i class="material-icons">${product.estado === 'activo' ? 'block' : 'restore'}</i></button>
                    </td>
                  </tr>`;
              }).join('');
            }

            function resetForm() {
              productForm.reset();
              editingId = null;
              formTitle.textContent = 'Registro de Producto';
              cancelEditBtn.style.display = 'none';
              document.getElementById('productId').value = '';
              document.getElementById('codigo').removeAttribute('readonly');
            }

            productForm.addEventListener('submit', (e) => {
              e.preventDefault();
              const formData = new FormData(productForm);
              const product = {
                codigo: formData.get('codigo'),
                nombre: formData.get('nombre'),
                descripcion: formData.get('descripcion'),
                categoria: formData.get('categoria'),
                stock: Number(formData.get('stock')),
                unidad: formData.get('unidad'),
                precio: Number(formData.get('precio')),
                proveedor: formData.get('proveedor')
              };
              try {
                if (editingId) {
                  Inventory.updateProduct(editingId, product);
                  Helpers.handleError({ message: 'Producto actualizado con éxito' });
                } else {
                  Inventory.addProduct(product);
                  Helpers.handleError({ message: 'Producto registrado con éxito' });
                }
                resetForm();
                loadProducts();
              } catch (error) {
                Helpers.handleError(error);
              }
            });

            searchInput.addEventListener('input', (e) => {
              const filteredProducts = Inventory.searchProducts(e.target.value);
              renderProducts(filteredProducts);
            });

            cancelEditBtn.addEventListener('click', resetForm);
            loadProveedores();
            loadProducts();
          });

          window.editProduct = function (id) {
            const product = Inventory.getProduct(id);
            if (product) {
              editingId = id;
              document.getElementById('productId').value = id;
              document.getElementById('codigo').value = product.codigo;
              document.getElementById('codigo').readOnly = true;
              document.getElementById('inventario_nombre').value = product.nombre;
              document.getElementById('inventario_descripcion').value = product.descripcion || '';
              document.getElementById('categoria').value = product.categoria;
              document.getElementById('stock').value = product.stock;
              document.getElementById('unidad').value = product.unidad;
              document.getElementById('precio').value = product.precio;
              document.getElementById('inventario_proveedor_select').value = product.proveedor;
              document.getElementById('inventario_formTitle').textContent = 'Editar Producto';
              document.getElementById('inventario_cancelEdit').style.display = 'inline-block';
            }
          };

          window.toggleProductStatus = function (id) {
            const product = Inventory.getProduct(id);
            if (product && confirm(`¿Está seguro de ${product.estado === 'activo' ? 'desactivar' : 'reactivar'} este producto?`)) {
              try {
                if (product.estado === 'activo') {
                  Inventory.deleteProduct(id);
                  Helpers.handleError({ message: 'Producto desactivado con éxito' });
                } else {
                  Inventory.updateProduct(id, { estado: 'activo' });
                  Helpers.handleError({ message: 'Producto reactivado con éxito' });
                }
                loadProducts();
              } catch (error) {
                Helpers.handleError(error);
              }
            }
          };
        </script>
      </div>
    </section>

    <!-- Sección: Configuración y Gestión de Usuarios -->
    <section id="usuarios" class="seccion">
      <h2>Configuración y Gestión de Usuarios</h2>
      <div class="panel-admin">
        <h2>Administración de Usuarios</h2>
        <form action="gestionar_usuario.php" method="POST">
          <label for="nombre_usuario">Nombre de Usuario:</label>
          <input type="text" id="nombre_usuario" name="nombre_usuario" required><br><br>
          <label for="correo_usuario">Correo Electrónico:</label>
          <input type="email" id="correo_usuario" name="correo_usuario" required><br><br>
          <label for="contraseña_usuario">Contraseña:</label>
          <input type="password" id="contraseña_usuario" name="contraseña_usuario" required><br><br>
          <label for="tipo_usuario">Tipo de Usuario:</label>
          <select id="tipo_usuario" name="tipo_usuario">
            <option value="administrador">Administrador</option>
            <option value="empleado">Empleado</option>
          </select><br><br>
          <button type="submit">Crear o Modificar Usuario</button>
        </form>
        <h3>Eliminar Usuario:</h3>
        <form action="eliminar_usuario.php" method="POST">
          <label for="eliminar_usuario">Nombre de Usuario:</label>
          <input type="text" id="eliminar_usuario" name="eliminar_usuario" required><br><br>
          <button type="submit">Eliminar Usuario</button>
        </form>
      </div>
      <h2>Matriz de Permisos</h2>
      <table id="matriz-permisos">
        <thead>
          <tr>
            <th>Acción</th>
            <th>Administrador</th>
            <th>Empleado</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Registrar Productos</td>
            <td><input type="checkbox" checked disabled></td>
            <td><input type="checkbox"></td>
          </tr>
          <tr>
            <td>Modificar Existencias</td>
            <td><input type="checkbox" checked disabled></td>
            <td><input type="checkbox"></td>
          </tr>
          <tr>
            <td>Generar Reportes</td>
            <td><input type="checkbox" checked disabled></td>
            <td><input type="checkbox"></td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Sección: Pedidos y Despachos -->
    <section id="pedidos" class="seccion">
      <button class="btn-desplegar" onclick="toggleForm('despacho')">Generar Solicitud de Despacho</button>
      <div id="form-despacho" class="formulario-desplegable">
        <h2>Generación de Documento de Despacho</h2>
        <form action="generar_despacho.php" method="POST">
          <label for="pedidos_proveedor_input">Proveedor:</label>
          <input type="text" id="pedidos_proveedor_input" name="proveedor" required><br><br>
          <label for="producto">Producto:</label>
          <input type="text" id="producto" name="producto" required><br><br>
          <label for="cantidad">Cantidad:</label>
          <input type="number" id="cantidad" name="cantidad" required><br><br>
          <label for="fecha_despacho">Fecha de Despacho:</label>
          <input type="date" id="fecha_despacho" name="fecha_despacho" required><br><br>
          <button type="submit" class="btn-despacho">Generar Documento</button>
        </form>
      </div>

      <button class="btn-desplegar" onclick="toggleForm('materia')">Generar Solicitud de Materia Prima</button>
      <div id="form-materia" class="formulario-desplegable">
        <h2>Solicitud de Materia Prima</h2>
        <form action="solicitar_materia.php" method="POST">
          <label for="producto_solicitado">Producto:</label>
          <input type="text" id="producto_solicitado" name="producto_solicitado" required><br><br>
          <label for="cantidad_solicitada">Cantidad Solicitada:</label>
          <input type="number" id="cantidad_solicitada" name="cantidad_solicitada" required><br><br>
          <label for="fecha_entrega">Fecha de Entrega Estimada:</label>
          <input type="date" id="fecha_entrega" name="fecha_entrega" required><br><br>
          <label for="departamento">Departamento Solicitante:</label>
          <input type="text" id="departamento" name="departamento" required><br><br>
          <button type="submit" class="btn-solicitar">Enviar Solicitud</button>
        </form>
      </div>
    </section>

  </main>

  <script>
    const enlacesMenu = document.querySelectorAll('.menu-lateral a');
    const secciones = document.querySelectorAll('.seccion');
    enlacesMenu.forEach(enlace => {
      enlace.addEventListener('click', (e) => {
        e.preventDefault();
        const seccionActiva = enlace.dataset.seccion;
        secciones.forEach(sec => sec.classList.remove('activa'));
        document.getElementById(seccionActiva).classList.add('activa');
      });
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

  <!--
    NOTA: Los siguientes bloques de script han sido comentados porque contenían errores.
    Intentaban acceder a elementos con IDs que no existen en el HTML (como 'tabla-historial' o 'form-proveedor')
    o que estaban duplicados y ahora han sido renombrados. Dejarlos activos causaría errores en la consola del navegador.
  -->
  <!--
   <script>
    const datosHistorial = [{ fecha: "2025-01-01", proveedor: "Proveedor A", cantidad: "100 unidades", calidad: "Alta", ubicacion: "Bodega 1", lote: "Lote001", registradoPor: "Usuario1" }, { fecha: "2025-01-15", proveedor: "Proveedor B", cantidad: "50 unidades", calidad: "Media", ubicacion: "Bodega 2", lote: "Lote002", registradoPor: "Usuario2" }];
    const tablaHistorial = document.getElementById("tabla-historial");
    datosHistorial.forEach((dato) => {
      const fila = document.createElement("tr");
      fila.innerHTML = `<td>${dato.fecha}</td><td>${dato.proveedor}</td><td>${dato.cantidad}</td><td>${dato.calidad}</td><td>${dato.ubicacion}</td><td>${dato.lote}</td><td>${dato.registradoPor}</td>`;
      tablaHistorial.appendChild(fila);
    });
    const formProveedor = document.getElementById("form-proveedor");
    formProveedor.addEventListener("submit", (e) => {
      e.preventDefault();
      const nuevoProveedor = { nombre: document.getElementById("nombre").value, direccion: document.getElementById("direccion").value, telefono: document.getElementById("telefono").value, correo: document.getElementById("correo").value, productos: document.getElementById("productos").value, condiciones: document.getElementById("condiciones").value, };
      let proveedores = JSON.parse(localStorage.getItem("proveedores")) || [];
      proveedores.push(nuevoProveedor);
      localStorage.setItem("proveedores", JSON.stringify(proveedores));
      alert("Proveedor registrado con éxito.");
      formProveedor.reset();
    });
   </script>
   <script>
    document.addEventListener("DOMContentLoaded", function () {
      const formRegistroProducto = document.getElementById("form-registro-producto");
      formRegistroProducto.addEventListener("submit", function (e) {
        e.preventDefault();
        const producto = { codigo: document.getElementById("codigo-producto").value, descripcion: document.getElementById("descripcion").value, proveedor: document.getElementById("proveedor").value, unidadMedida: document.getElementById("unidad-medida").value, especificaciones: document.getElementById("especificaciones").value, };
        const productos = JSON.parse(localStorage.getItem("productos")) || [];
        productos.push(producto);
        localStorage.setItem("productos", JSON.stringify(productos));
        alert("Producto registrado con éxito.");
        formRegistroProducto.reset();
      });
      const existencias = [{ producto: "Producto A", cantidad: 100, ubicacion: "Zona 1", vencimiento: "2025-01-01" }, { producto: "Producto B", cantidad: 50, ubicacion: "Zona 2", vencimiento: "2024-12-01" }];
      function renderTablaExistencias() {
        const tabla = document.getElementById("tabla-existencias");
        tabla.innerHTML = "";
        existencias.forEach((item, index) => {
          const row = `<tr><td>${item.producto}</td><td><input type="number" value="${item.cantidad}" class="form-control" /></td><td>${item.ubicacion}</td><td>${item.vencimiento}</td><td><button class="btn btn-success" onclick="guardarCambios(${index})">Guardar</button></td></tr>`;
          tabla.innerHTML += row;
        });
      }
      window.guardarCambios = function (index) {
        const cantidad = document.querySelectorAll("#tabla-existencias input")[index].value;
        existencias[index].cantidad = parseInt(cantidad, 10);
        alert("Cantidad actualizada con éxito.");
        renderTablaExistencias();
      };
      renderTablaExistencias();
    });
  </script>
  -->

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    function toggleForm(formType) {
      var form = document.getElementById('form-' + formType);
      if (form.style.display === "none" || form.style.display === "") {
        form.style.display = "block";
      } else {
        form.style.display = "none";
      }
    }
  </script>

</body>
</html>